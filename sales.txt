import pandas as pd
df = pd.read_csv('/kaggle/input/sample-sales-data/sales_data_sample.csv',encoding='latin1')
df.head()
df.info()
df = df.drop(columns=['ORDERNUMBER','ORDERDATE','ADDRESSLINE1','ADDRESSLINE2','CONTACTLASTNAME','CONTACTFIRSTNAME','CUSTOMERNAME','PHONE'])
df
df.isnull().sum()
df.drop(columns=['STATE','POSTALCODE','TERRITORY','QTR_ID','MONTH_ID'],inplace=True)
df
df.duplicated().sum()
from sklearn.preprocessing import LabelEncoder
en = LabelEncoder()
df['STATUS'] = en.fit_transform(df['STATUS'])
df['PRODUCTLINE'] = en.fit_transform(df['PRODUCTLINE'])
df['PRODUCTCODE'] = en.fit_transform(df['PRODUCTCODE'])
df['CITY'] = en.fit_transform(df['CITY'])
df['COUNTRY'] = en.fit_transform(df['COUNTRY'])
df['DEALSIZE'] = en.fit_transform(df['DEALSIZE'])
df.head()
from sklearn.cluster import KMeans
wcss = []
for i in range(1,21):
    km = KMeans(n_clusters=i)
    km.fit_predict(df)
    wcss.append(km.inertia_)
wcss
import matplotlib.pyplot as plt
plt.plot(wcss)
km = KMeans(n_clusters=4)
pred = km.fit_predict(df)
df['label'] = pred
df.head()